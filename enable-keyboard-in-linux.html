<!DOCTYPE html>
<!--
(¯`·.¸¸.·´¯`·.¸¸.-> ĊÄĻĻ MË ĻŮŚÏŖ <-.¸¸.·´¯`·.¸¸.·´¯)
-->
<html lang="en-US">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="format-detection" content="telephone=no">
<meta name="renderer" content="webkit">
<meta name="author" content="Nero Zheng" />
<meta name="generator" content="Pelican" />
<meta name="description" content="Linux 下 Lenovo S10-3C 开启键盘 - 作者：Nero Zheng，首发于『擼sirの避風港』">
<meta property="qc:admins" content="315026325312655" />
<meta property="wb:webmaster" content="8e383b094667a02d" />
<title>Linux 下 Lenovo S10-3C 开启键盘 - 擼sirの避風港</title>
<link href="https://lusir.me/atom.xml" type="application/atom+xml" rel="alternate" title="『擼sirの避風港』Atom Feed" />
<link href="https://lusir.me/rss.xml" type="application/rss+xml" rel="alternate" title="『擼sirの避風港』Rss Feed" />
<link rel="shortcut icon" type="image/x-icon" href="/images/favicon/favicon.ico" />
<link rel="apple-touch-icon" sizes="114x114" href="/images/favicon/apple-touch-icon-114x114.png" />
<link rel="icon" type="image/png" href="/images/favicon/favicon-32x32.png" sizes="32x32" />
<script src="/theme/js/basket.min.js"></script>
<script>
basket.require({ url: '/theme/css/bootstrap.min.css' },{ url: '/theme/css/niu2.css', unique: 0.1 },{ url: '/theme/font-awesome/css/font-awesome.min.css', unique: 0.1 },{ url: '/theme/css/pygments/github.css' },{ url: '/theme/css/jquery.fancybox.css' })
.then(function(responses) {
_stylesheet.appendStyleSheet(responses[0], function() {});
	basket.require({ url: '/theme/js/bootstrap.min.js' },{ url: '/theme/js/jquery-1.11.0.min.js' },{ url: '/theme/js/niu2.js', unique: 0.2 },{ url: '/theme/js/fancy-loading.js' },{ url: '/theme/js/jquery.fancybox.pack.js' },{ url: '/theme/js/jquery-1.4.4.min.js' },{ url: '/theme/js/slimbox2.js' },{ url: '/theme/js/APlayer.min.js' },{ url: '/theme/js/tagcloud.min.js' });});
</script>
<link rel="stylesheet" href="/theme/css/bootstrap.min.css" type="text/css" />
<link rel="stylesheet" href="/theme/font-awesome/css/font-awesome.min.css" type="text/css" />
<link rel="stylesheet" href="/theme/css/niu2.css" type="text/css" />
<script type="text/javascript">window.onload = function() {  };</script>
<link rel="stylesheet" href="https://lusir.me/theme/css/pygments/github.css" type="text/css" />
<link rel="stylesheet" href="https://lusir.me/theme/css/jquery.fancybox.css" type="text/css" />
<link rel="canonical" href="https://lusir.me/enable-keyboard-in-linux.html" />
<!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
<!--[if lt IE 9]>
<script src="/theme/js/html5shiv.js"></script>
<script src="/theme/js/respond.min.js"></script>
<![endif]-->
<!--[if IE 7]>
<link rel="stylesheet" href="/theme/font-awesome/css/font-awesome-ie7.min.css" type="text/css" />
<![endif]-->
</head>

<body itemscope itemtype="http://schema.org/WebPage"> 
<meta itemprop="inLanguage" content="zh-CN">
<div id="body-header">
<div class="navbar navbar-inverse navbar-fixed-top">
<div class="col-md-12">
<div class="navbar-header">
<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
<span class="icon-bar"></span>
<span class="icon-bar"></span>
<span class="icon-bar"></span>
</button>
<a class="navbar-brand" href="https://lusir.me"><i class="fa fa-home"></i>擼sirの避風港</a>
</div>
<nav class="collapse navbar-collapse bs-navbar-collapse" role="navigation">
<ul class="nav navbar-nav">
<li><a href="https://lusir.me/gallery.html" title="图册"><i class="fa fa-picture-o"></i>图册</a></li>
<li><a href="https://lusir.me/archives.html" title="存档"><i class="fa fa-archive"></i>存档</a></li>
<li><a href="https://lusir.me/tag/" title="标签"><i class="fa fa-tag"></i>标签</a></li>
<!-- category dropdown list -->
<li class="dropdown">
<a href="#" class="dropdown-toggle" data-toggle="dropdown"><i class="fa fa-folder-open"></i>分类<b class="caret"></b></a>
<ul class="dropdown-menu">
<li><a href="https://lusir.me/collection/index.html"><i class="fa fa-briefcase"></i>搜藏(4)</a></li>
<li><a href="https://lusir.me/nonsense/index.html"><i class="fa fa-cogs"></i>扯(1)</a></li>
<li><a href="https://lusir.me/record/index.html"><i class="fa fa-book"></i>记录(81)</a></li>
</ul>
</li>
<!--  self defined dropdown list --></ul>
<!-- right nav bar -->
<ul class="nav navbar-nav navbar-right">
<!-- google custom search --><li>
<div id="niu2-cse-wrapper">
<div id="niu2-cse-header-box" class="navbar-form navbar-nav">
<form action="/search.html" method="get">
<div class="form-group">
<input id="niu2-cse-search-input" class="niu2-cse-header form-control" type="text" name="q" placeholder="回车以搜索…" />
</div>
</form>
</div>
<div id="niu2-cse-ctrl-box" class="navbar-nav"><i id="niu2-cse-search-image" class="fa fa-search navbar-nav"></i><span id="niu2-cse-search-text">搜索</span></div>
</div>
</li></ul>
</nav>
</div>
</div></div>

<div id="body-content" itemscope="itemscope" itemtype="https://schema.org/Article"><div class="col-md-8 col-md-offset-2"><h1 id="content-heading" itemprop="headline">Linux 下 Lenovo S10-3C 开启键盘</h1>
<div class="post-meta" itemprop="datePublished">May 25,2014</div></div>
<div id="niu2-left-container" class="col-md-6 col-md-offset-2">
<div id="niu2-main-content" itemprop="articleBody">
<p>注：Lubuntu 12.04 下开启成功。</p>


<p>之前在<a href="https://lusir.me/setup-lubuntu.html" title="Lusir Lubuntu - 安装篇">《Lenovo S10-3C 上安装 Lubuntu》</a>中提到过 Lenovo S10-3C 的 BIOS 是存在缺陷的，不能支持 Linux 的内核，而且官方也并没有要修正的意思（这么多年都过去了）。
</p>
<p>当时在论坛上找到过一篇老毛子的教程，编译一份启动键盘的脚本并让它开机启动就能解决问题。当时我没有解决，不过这次心血来潮再次折腾竟成功了，确实很欣慰，记录一下……</p>
<h3 id="cd25acb9fca49873079b8dc3ebc5021b">创建脚本</h3>
<p>首先创建一个 .c 文件如 kbd.c，复制一下内容并保存：</p>
<div class="codehilite"><pre><span class="cp">#include &lt;unistd.h&gt;</span>
<span class="cp">#include &lt;sys/io.h&gt;</span>
<span class="cp">#define I8042_COMMAND_REG 0x64</span>
<span class="kt">int</span> <span class="nf">main</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span><span class="n">argv</span><span class="p">[])</span> <span class="p">{</span>
<span class="kt">char</span> <span class="n">data</span> <span class="o">=</span> <span class="mh">0xae</span><span class="p">;</span> <span class="c1">// enable keyboard</span>
<span class="n">ioperm</span><span class="p">(</span><span class="n">I8042_COMMAND_REG</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
<span class="k">if</span> <span class="p">(</span><span class="n">argc</span> <span class="o">==</span> <span class="mi">2</span> <span class="o">&amp;&amp;</span> <span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="sc">&#39;0&#39;</span><span class="p">)</span>
  <span class="n">data</span> <span class="o">=</span> <span class="mh">0xad</span><span class="p">;</span> <span class="c1">// disable keyboard</span>
<span class="n">outb</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">I8042_COMMAND_REG</span><span class="p">);</span>
<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>


<h3 id="27470a0ac3af4bafd415ca0aa498e297">编译脚本</h3>
<p>打开终端，进入此文件所在目录，使用以下命令编译：</p>
<div class="codehilite"><pre><span class="n">gcc</span> <span class="n">kbd</span><span class="p">.</span><span class="n">c</span> <span class="o">-</span><span class="n">o</span> <span class="n">keyboard</span>
</pre></div>


<h3 id="12bb593fd1f45ba7bbe017d3fe06d51d">使用脚本</h3>
<p>将编译好的 keyboard 文件复制到 /bin 目录，</p>
<div class="codehilite"><pre><span class="n">cp</span> <span class="n">keyboard</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span>
</pre></div>


<p>通过终端取得高阶权限编辑 rc.local 文件：</p>
<div class="codehilite"><pre><span class="n">sudo</span> <span class="n">sublime</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rc</span><span class="p">.</span><span class="n">local</span>
</pre></div>


<p>在其 exit 0 前面添加：</p>
<div class="codehilite"><pre><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">keyboard</span> <span class="mi">1</span>
</pre></div>


<p>最后给文件执行权限：</p>
<div class="codehilite"><pre><span class="n">chmod</span> <span class="mi">755</span> <span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">rc</span><span class="p">.</span><span class="n">local</span>
<span class="n">chmod</span> <span class="o">+</span><span class="n">x</span> <span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">keyboard</span>
</pre></div>


<p><br>
大功告成，重启即可正常使用自带键盘……
<br></p>
<div id="player" class="aplayer"></div>

<script>
var ap = new APlayer({
    element: document.getElementById('player'),
    narrow: false,
    autoplay: true,
    showlrc: false,
    mutex: true,
    theme: '#615754',
    mode: 'circulation',
    preload: 'auto',
    music: {title: '忘不了',author: '童安格',
                url: 'https://nnero.gitee.io/demo/wangbuliao.mp3',
                pic: 'https://p1.music.126.net/4xBMMWES9qzUOqT24hJVHA==/27487790706459.jpg',}
    });
</script>

<p><br></p>
<h3 id="2a302fa545ce4445b25970650930debd">参考文章</h3>
<ul>
<li><a href="http://help.ubuntu.ru/%D1%81%D0%BE%D0%B2%D0%BC%D0%B5%D1%81%D1%82%D0%B8%D0%BC%D0%BE%D1%81%D1%82%D1%8C/s10-3c#%D0%BA%D0%BB%D0%B0%D0%B2%D0%B8%D0%B0%D1%82%D1%83%D1%80%D0%B0" title="Lenovo S10-3C">Lenovo S10-3C</a></li>
<li><a href="https://ask.fedoraproject.org/en/question/6995/ideapad-s10-3c-keyboard-not-working/" title="Ideapad S10-3C Keyboard Not Working">Ideapad S10-3C Keyboard Not Working</a></li>
</ul>
</div>

<div id="content-comments">

</div>

</div>
<div id="niu2-right-container" class="col-md-3">
<div id="niu2-sidebar-meta" class="niu2-sidebar">
<div class="niu2-sidebar-label"><i class="fa fa-bug"></i>文章作者</div>
<div class="niu2-sidebar-value" itemprop="author">Nero Zheng</div><p class="hidden">By Nero Zheng</p>
<div class="niu2-sidebar-label"><i class="fa fa-calendar"></i>发布时间</div>
<div class="niu2-sidebar-value" itemprop="datePublished">2014-05-25 10:40</div>
<div class="niu2-sidebar-label"><i class="fa fa-book"></i>分类</div>
<div class="niu2-sidebar-value" itemprop="articleSection"><a href="https://lusir.me/record/index.html">记录</a></div>
<div class="niu2-sidebar-label"><i class="fa fa-tag"></i>标签</div>
<div class="niu2-sidebar-inter-value niu2-sidebar-tag" itemprop="keywords"><a href="https://lusir.me/tag/lubuntu.html">Lubuntu</a></div>
<div class="niu2-sidebar-inter-value niu2-sidebar-tag" itemprop="keywords"><a href="https://lusir.me/tag/s10-3c.html">S10-3C</a></div>
<div class="niu2-sidebar-inter-value niu2-sidebar-tag" itemprop="keywords"><a href="https://lusir.me/tag/music.html">Music</a></div>
 
</div>

<div id="niu2-sidebar-toc" class="niu2-sidebar" data-status="closed">
<div class="niu2-sidebar-label">
<i id="niu2-sidebar-toc-ctrl" class="fa fa-plus"></i>目录
</div>
<ol id="niu2-sidebar-toc-list">
<li><a href="#content-heading">Linux 下 Lenovo S10-3C 开启键盘</a></li>
    <li><a href='#cd25acb9fca49873079b8dc3ebc5021b'>创建脚本</a></li><li><a href='#27470a0ac3af4bafd415ca0aa498e297'>编译脚本</a></li><li><a href='#12bb593fd1f45ba7bbe017d3fe06d51d'>使用脚本</a></li><li><a href='#2a302fa545ce4445b25970650930debd'>参考文章</a></li>
</ol></div>

<div class="hidden">
<div itemscope itemtype="https://data-vocabulary.org/Breadcrumb"><a href="https://lusir.me" itemprop="url"><span itemprop="title">Home</span></a>&nbsp;&gt;&nbsp;</div>
<div itemscope itemtype="https://data-vocabulary.org/Breadcrumb"><a href="https://lusir.me/record/index.html" itemprop="url"><span itemprop="title">记录</span></a></div>&nbsp;&gt;&nbsp;Linux 下 Lenovo S10-3C 开启键盘
</div>

<div class="hidden">
<ul>
<li class="prev"><a href="https://lusir.me/notes-of-win-pelican.html">上一篇</a></li>
<li class="next"><a href="https://lusir.me/flash-bios-of-p151em.html">下一篇</a></li>
</ul>
</div>

<div class="hidden">
<p>相关文章</p>
<ul>
<li><a href="https://lusir.me/setup-lubuntu.html">Lusir Lubuntu  - 安装篇</a></li>
<li><a href="https://lusir.me/notes-of-win-pelican.html">Pelican 在 Windows 下的静态文件及目录拷贝</a></li>
<li><a href="https://lusir.me/solutions-to-wp8.html">WP8 遭遇问题记录</a></li>
<li><a href="https://lusir.me/solution-to-insufficient-permissions.html">Weibo 提示 “Insufficient App Permissions” 的解决办法</a></li>
<li><a href="https://lusir.me/after-enabling-application-cache.html">启用 Application Cache（续）</a></li>
<li><a href="https://lusir.me/embed-html5-media.html">在网页中嵌入 html5 音视频</a></li>
<li><a href="https://lusir.me/embed-hermit-player.html">在网页中嵌入 hermit 播放器</a></li>
<li><a href="https://lusir.me/shutdown-windows-in-cmd.html">Windows 下命令行关机</a></li>
</ul>
 
</div></div>
</div><div id="body-footer" class="col-md-6 col-md-offset-2"><div class="niu2-footer">
<p>Generated by <a href="https://github.com/getpelican/pelican">Pelican</a> with Theme <a href="https://github.com/mawenbao/niu-x2-sidebar">Niu-X2</a> & Hosted by <a href="https://github.com">Github</a>, No Right Reserved<a href="https://plus.google.com/+NeroZheng" rel="author">.</a>
</p>
</div></div>
<script type="text/javascript" src="/theme/js/jquery-1.11.0.min.js"></script>
<script type="text/javascript" src="/theme/js/niu2.js"></script>
<script type="text/javascript" src="/theme/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://lusir.me/theme/js/fancy-loading.js"></script>
<script type="text/javascript" src="https://lusir.me/theme/js/jquery.fancybox.pack.js"></script>
<script type="text/javascript">onContentLoaded();</script>

<!-- GoogleAnalytics -->
<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','//www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-36540079-1', 'lusir.me');
ga('require', 'linkid', 'linkid.js');
ga('send', 'pageview');
</script>

<!-- Baidu Autopush -->
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';}
    else {bp.src = 'http://push.zhanzhang.baidu.com/push.js';}
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);})();
</script>

<!-- Baidu Tongji -->
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3Fffe778a70caf3e0916e5372ab2ebb506' type='text/javascript'%3E%3C/script%3E"));
</script>

</body>
</html>